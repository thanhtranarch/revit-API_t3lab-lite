<Grid
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid.Resources>
        <SolidColorBrush x:Key="bg_white" Color="White"/>
        <SolidColorBrush x:Key="bg_light" Color="#F5F5F5"/>
        <SolidColorBrush x:Key="bg_panel" Color="#FAFAFA"/>
        <SolidColorBrush x:Key="border_gray" Color="#D0D0D0"/>
        <SolidColorBrush x:Key="border_light" Color="#E0E0E0"/>
        <SolidColorBrush x:Key="text_dark" Color="#333333"/>
        <SolidColorBrush x:Key="text_gray" Color="#888888"/>
        <SolidColorBrush x:Key="accent_green" Color="#8BC34A"/>
        <SolidColorBrush x:Key="accent_yellow" Color="#FFC107"/>
        <SolidColorBrush x:Key="accent_red" Color="#F44336"/>
        <SolidColorBrush x:Key="accent_blue" Color="#2196F3"/>
        <SolidColorBrush x:Key="export_green" Color="#8BC34A"/>
        <SolidColorBrush x:Key="import_orange" Color="#FF9800"/>

        <Style x:Key="SmallButton" TargetType="Button">
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderBrush" Value="#D0D0D0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Padding" Value="6,3"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="2"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E0E0E0"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.5"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.5"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ArrowButton" TargetType="Button">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="BorderBrush" Value="#D0D0D0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="2">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E0E0E0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="TabStyle" TargetType="TabItem">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="12,6"/>
        </Style>

        <!-- Window Control Button Style (BatchOut style) -->
        <Style x:Key="WindowControlButton" TargetType="Button">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#ECF0F1"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Close Button Style (Red on hover, BatchOut style) -->
        <Style x:Key="CloseButton" TargetType="Button">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#E74C3C"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Grid.Resources>

    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Row 0: Custom Title Bar (BatchOut style) -->
    <Grid Grid.Row="0" Background="White" Height="80">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <!-- Logo and Title -->
        <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="15,0,0,0" VerticalAlignment="Center">
            <Image x:Name="logo_image" Width="80" Height="80" Margin="0,0,15,0"/>
            <StackPanel VerticalAlignment="Center">
                <TextBlock Text="ParaSync" FontSize="22" FontWeight="Bold"
                          Foreground="#2C3E50" Margin="0,0,0,5"/>
                <Separator Height="2" Background="#BDC3C7" Margin="0,3,0,5"/>
                <TextBlock Text="Export/Import parameter data to Excel - SheetLink style"
                          FontSize="11" Foreground="#7F8C8D" FontStyle="Italic"/>
            </StackPanel>
        </StackPanel>

        <!-- Window Control Buttons -->
        <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Top" Margin="0,0,5,0">
            <!-- Profile Button -->
            <Button x:Name="btn_profile"
                    Style="{StaticResource WindowControlButton}"
                    ToolTip="Profiles">
                <TextBlock Text="&#x1F464;" FontSize="18" Foreground="#7F8C8D"/>
            </Button>

            <!-- Minimize Button -->
            <Button x:Name="btn_minimize"
                    Style="{StaticResource WindowControlButton}"
                    ToolTip="Minimize">
                <TextBlock Text="&#x2014;" FontSize="14" FontWeight="Bold" Foreground="#7F8C8D" Margin="0,-8,0,0"/>
            </Button>

            <!-- Maximize/Restore Button -->
            <Button x:Name="btn_maximize"
                    Style="{StaticResource WindowControlButton}"
                    ToolTip="Maximize">
                <Border BorderBrush="#7F8C8D" BorderThickness="2" Width="14" Height="14"/>
            </Button>

            <!-- Close Button -->
            <Button x:Name="btn_close_window"
                    Style="{StaticResource CloseButton}"
                    ToolTip="Close">
                <TextBlock x:Name="close_text" Text="&#x2715;" FontSize="18" FontWeight="Bold" Foreground="#7F8C8D"/>
            </Button>
        </StackPanel>
    </Grid>

    <!-- Row 1: Sub-header with Profile + Progress -->
    <Border Grid.Row="1" Background="#F8F9FA" BorderBrush="#E0E0E0" BorderThickness="0,1,0,1" Padding="15,6">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Profile Controls -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="Profile" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="#555" FontSize="12"/>
                <ComboBox x:Name="profile_combo" Width="160" Height="26" VerticalContentAlignment="Center"/>
                <Button x:Name="btn_save_profile" Content="&#x1F4BE;" Width="28" Height="26" Margin="4,0,0,0"
                        Style="{StaticResource SmallButton}" ToolTip="Save Profile"/>
                <Button x:Name="btn_delete_profile" Content="&#x1F5D1;" Width="28" Height="26" Margin="2,0,0,0"
                        Style="{StaticResource SmallButton}" ToolTip="Delete Profile"/>
            </StackPanel>

            <!-- Progress -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="Completed" VerticalAlignment="Center" Margin="0,0,6,0" Foreground="#555" FontSize="12"/>
                <ProgressBar x:Name="progress_bar" Width="100" Height="16" Value="0" Minimum="0" Maximum="100"/>
                <TextBlock x:Name="progress_text" Text="0%" VerticalAlignment="Center" Margin="6,0,0,0" Foreground="#555" FontSize="12"/>
            </StackPanel>
        </Grid>
    </Border>

    <!-- Row 2: Tab Control -->
    <TabControl x:Name="main_tabs" Grid.Row="2" Margin="0">

        <!-- MODEL CATEGORIES TAB -->
        <TabItem Header="Model Categories" Style="{StaticResource TabStyle}">
            <Grid Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Scope selection row -->
                <Grid Grid.Row="0" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <RadioButton x:Name="mc_scope_whole" Content="Whole Model" GroupName="mc_scope"
                                     IsChecked="True" Margin="0,0,16,0" VerticalAlignment="Center"/>
                        <RadioButton x:Name="mc_scope_active" Content="Active View" GroupName="mc_scope"
                                     Margin="0,0,16,0" VerticalAlignment="Center"/>
                        <RadioButton x:Name="mc_scope_selection" Content="Current Selection" GroupName="mc_scope"
                                     VerticalAlignment="Center"/>
                    </StackPanel>
                    <Button x:Name="mc_btn_isolate" Grid.Column="2" Content="Isolate Selection"
                            Style="{StaticResource SmallButton}" Margin="0,0,6,0" Padding="10,4"/>
                    <Button x:Name="mc_btn_export_standards" Grid.Column="3" Content="Export Project Standards"
                            Style="{StaticResource SmallButton}" Padding="10,4"/>
                </Grid>

                <!-- 3-column layout -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="250"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Col 0: Select Categories -->
                    <Border Grid.Column="0" BorderBrush="#D0D0D0" BorderThickness="1" Margin="0,0,4,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox x:Name="mc_check_all_cats" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                    <TextBlock Grid.Column="1" Text="Select Categories" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                            <ComboBox x:Name="mc_discipline_filter" Grid.Row="1" Margin="4" Height="24" FontSize="11"/>
                            <Grid Grid.Row="2" Margin="4,0,4,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="mc_search_categories" Grid.Column="0" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                                <TextBlock Grid.Column="1" Text="&#x1F50D;" VerticalAlignment="Center" Margin="4,0,0,0" FontSize="12"/>
                            </Grid>
                            <ListBox x:Name="mc_category_list" Grid.Row="3" BorderThickness="0"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"/>
                            <CheckBox x:Name="mc_hide_unchecked" Grid.Row="4" Content="Hide un-checked categories"
                                      Margin="6,4" FontSize="11"/>
                        </Grid>
                    </Border>

                    <!-- Col 1: Available Parameters -->
                    <Border Grid.Column="1" BorderBrush="#D0D0D0" BorderThickness="1" Margin="4,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <TextBlock Text="Available Parameters" FontWeight="SemiBold" FontSize="12"/>
                            </Border>
                            <ComboBox x:Name="mc_avail_param_filter" Grid.Row="1" Margin="4" Height="24" FontSize="11"/>
                            <Grid Grid.Row="2" Margin="4,0,4,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="mc_search_avail_params" Grid.Column="0" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                                <TextBlock Grid.Column="1" Text="&#x1F50D;" VerticalAlignment="Center" Margin="4,0,0,0" FontSize="12"/>
                            </Grid>
                            <ListBox x:Name="mc_avail_param_list" Grid.Row="3" BorderThickness="0"
                                     SelectionMode="Extended"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                        </Grid>
                    </Border>

                    <!-- Col 2: Arrow Buttons -->
                    <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Button x:Name="mc_btn_add_param" Content="&#x25B6;" Style="{StaticResource ArrowButton}" Margin="0,4"
                                ToolTip="Add selected parameters"/>
                        <Button x:Name="mc_btn_remove_param" Content="&#x25C0;" Style="{StaticResource ArrowButton}" Margin="0,4"
                                ToolTip="Remove selected parameters"/>
                    </StackPanel>

                    <!-- Col 3: Selected Parameters -->
                    <Border Grid.Column="3" BorderBrush="#D0D0D0" BorderThickness="1" Margin="4,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <TextBlock Text="Selected Parameters" FontWeight="SemiBold" FontSize="12"/>
                            </Border>
                            <ComboBox x:Name="mc_sel_param_filter" Grid.Row="1" Margin="4" Height="24" FontSize="11"/>
                            <Grid Grid.Row="2" Margin="4,0,4,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="mc_search_sel_params" Grid.Column="0" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                                <TextBlock Grid.Column="1" Text="&#x1F50D;" VerticalAlignment="Center" Margin="4,0,0,0" FontSize="12"/>
                            </Grid>
                            <ListBox x:Name="mc_sel_param_list" Grid.Row="3" BorderThickness="0"
                                     SelectionMode="Extended"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </TabItem>

        <!-- ANNOTATION CATEGORIES TAB -->
        <TabItem Header="Annotation Categories" Style="{StaticResource TabStyle}">
            <Grid Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <RadioButton x:Name="ac_scope_whole" Content="Whole Model" GroupName="ac_scope"
                                     IsChecked="True" Margin="0,0,16,0" VerticalAlignment="Center"/>
                        <RadioButton x:Name="ac_scope_active" Content="Active View" GroupName="ac_scope"
                                     Margin="0,0,16,0" VerticalAlignment="Center"/>
                        <RadioButton x:Name="ac_scope_selection" Content="Current Selection" GroupName="ac_scope"
                                     VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="250"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" BorderBrush="#D0D0D0" BorderThickness="1" Margin="0,0,4,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox x:Name="ac_check_all_cats" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                    <TextBlock Grid.Column="1" Text="Select Categories" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                            <Grid Grid.Row="1" Margin="4">
                                <TextBox x:Name="ac_search_categories" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                            </Grid>
                            <ListBox x:Name="ac_category_list" Grid.Row="2" BorderThickness="0"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                            <CheckBox x:Name="ac_hide_unchecked" Grid.Row="3" Content="Hide un-checked categories"
                                      Margin="6,4" FontSize="11"/>
                        </Grid>
                    </Border>
                    <Border Grid.Column="1" BorderBrush="#D0D0D0" BorderThickness="1" Margin="4,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <TextBlock Text="Available Parameters" FontWeight="SemiBold" FontSize="12"/>
                            </Border>
                            <ComboBox x:Name="ac_avail_param_filter" Grid.Row="1" Margin="4" Height="24" FontSize="11"/>
                            <Grid Grid.Row="2" Margin="4,0,4,4">
                                <TextBox x:Name="ac_search_avail_params" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                            </Grid>
                            <ListBox x:Name="ac_avail_param_list" Grid.Row="3" BorderThickness="0"
                                     SelectionMode="Extended"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                        </Grid>
                    </Border>
                    <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Button x:Name="ac_btn_add_param" Content="&#x25B6;" Style="{StaticResource ArrowButton}" Margin="0,4"/>
                        <Button x:Name="ac_btn_remove_param" Content="&#x25C0;" Style="{StaticResource ArrowButton}" Margin="0,4"/>
                    </StackPanel>
                    <Border Grid.Column="3" BorderBrush="#D0D0D0" BorderThickness="1" Margin="4,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <TextBlock Text="Selected Parameters" FontWeight="SemiBold" FontSize="12"/>
                            </Border>
                            <ComboBox x:Name="ac_sel_param_filter" Grid.Row="1" Margin="4" Height="24" FontSize="11"/>
                            <Grid Grid.Row="2" Margin="4,0,4,4">
                                <TextBox x:Name="ac_search_sel_params" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                            </Grid>
                            <ListBox x:Name="ac_sel_param_list" Grid.Row="3" BorderThickness="0"
                                     SelectionMode="Extended"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </TabItem>

        <!-- ELEMENTS TAB -->
        <TabItem Header="Elements" Style="{StaticResource TabStyle}">
            <Grid Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" Margin="0,0,0,8">
                    <StackPanel Orientation="Horizontal">
                        <RadioButton x:Name="el_scope_whole" Content="Whole Model" GroupName="el_scope"
                                     IsChecked="True" Margin="0,0,16,0" VerticalAlignment="Center"/>
                        <RadioButton x:Name="el_scope_active" Content="Active View" GroupName="el_scope"
                                     Margin="0,0,16,0" VerticalAlignment="Center"/>
                        <RadioButton x:Name="el_scope_selection" Content="Current Selection" GroupName="el_scope"
                                     VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="250"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" BorderBrush="#D0D0D0" BorderThickness="1" Margin="0,0,4,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox x:Name="el_check_all_cats" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                    <TextBlock Grid.Column="1" Text="Select Categories" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                            <Grid Grid.Row="1" Margin="4">
                                <TextBox x:Name="el_search_categories" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                            </Grid>
                            <ListBox x:Name="el_category_list" Grid.Row="2" BorderThickness="0"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                        </Grid>
                    </Border>
                    <Border Grid.Column="1" BorderBrush="#D0D0D0" BorderThickness="1" Margin="4,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <TextBlock Text="Available Parameters" FontWeight="SemiBold" FontSize="12"/>
                            </Border>
                            <ComboBox x:Name="el_avail_param_filter" Grid.Row="1" Margin="4" Height="24" FontSize="11"/>
                            <Grid Grid.Row="2" Margin="4,0,4,4">
                                <TextBox x:Name="el_search_avail_params" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                            </Grid>
                            <ListBox x:Name="el_avail_param_list" Grid.Row="3" BorderThickness="0"
                                     SelectionMode="Extended"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                        </Grid>
                    </Border>
                    <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Button x:Name="el_btn_add_param" Content="&#x25B6;" Style="{StaticResource ArrowButton}" Margin="0,4"/>
                        <Button x:Name="el_btn_remove_param" Content="&#x25C0;" Style="{StaticResource ArrowButton}" Margin="0,4"/>
                    </StackPanel>
                    <Border Grid.Column="3" BorderBrush="#D0D0D0" BorderThickness="1" Margin="4,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <TextBlock Text="Selected Parameters" FontWeight="SemiBold" FontSize="12"/>
                            </Border>
                            <ComboBox x:Name="el_sel_param_filter" Grid.Row="1" Margin="4" Height="24" FontSize="11"/>
                            <Grid Grid.Row="2" Margin="4,0,4,4">
                                <TextBox x:Name="el_search_sel_params" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                            </Grid>
                            <ListBox x:Name="el_sel_param_list" Grid.Row="3" BorderThickness="0"
                                     SelectionMode="Extended"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </TabItem>

        <!-- SCHEDULES TAB -->
        <TabItem Header="Schedules" Style="{StaticResource TabStyle}">
            <Grid Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,8">
                    <RadioButton x:Name="sc_scope_whole" Content="Whole Model" GroupName="sc_scope"
                                 IsChecked="True" Margin="0,0,16,0" VerticalAlignment="Center"/>
                    <RadioButton x:Name="sc_scope_active" Content="Active View" GroupName="sc_scope"
                                 VerticalAlignment="Center"/>
                </StackPanel>
                <Grid Grid.Row="1" Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="sc_search_schedules" Height="24" FontSize="11"
                             VerticalContentAlignment="Center" Padding="4,0"/>
                    <TextBlock Grid.Column="1" Text="&#x1F50D;" VerticalAlignment="Center" Margin="6,0,0,0" FontSize="12"/>
                </Grid>
                <Border Grid.Row="2" BorderBrush="#D0D0D0" BorderThickness="1">
                    <ListBox x:Name="sc_schedule_list" BorderThickness="0"
                             SelectionMode="Extended"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                </Border>
            </Grid>
        </TabItem>

        <!-- SPATIAL TAB -->
        <TabItem Header="Spatial" Style="{StaticResource TabStyle}">
            <Grid Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,8">
                    <RadioButton x:Name="sp_scope_whole" Content="Whole Model" GroupName="sp_scope"
                                 IsChecked="True" Margin="0,0,16,0" VerticalAlignment="Center"/>
                    <RadioButton x:Name="sp_scope_active" Content="Active View" GroupName="sp_scope"
                                 VerticalAlignment="Center"/>
                </StackPanel>
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="250"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="40"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border Grid.Column="0" BorderBrush="#D0D0D0" BorderThickness="1" Margin="0,0,4,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox x:Name="sp_check_all" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                    <TextBlock Grid.Column="1" Text="Select Rooms/Spaces" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                            <Grid Grid.Row="1" Margin="4">
                                <TextBox x:Name="sp_search_items" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                            </Grid>
                            <ListBox x:Name="sp_item_list" Grid.Row="2" BorderThickness="0"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                        </Grid>
                    </Border>
                    <Border Grid.Column="1" BorderBrush="#D0D0D0" BorderThickness="1" Margin="4,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <TextBlock Text="Available Parameters" FontWeight="SemiBold" FontSize="12"/>
                            </Border>
                            <Grid Grid.Row="1" Margin="4">
                                <TextBox x:Name="sp_search_avail_params" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                            </Grid>
                            <ListBox x:Name="sp_avail_param_list" Grid.Row="2" BorderThickness="0"
                                     SelectionMode="Extended"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                        </Grid>
                    </Border>
                    <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Button x:Name="sp_btn_add_param" Content="&#x25B6;" Style="{StaticResource ArrowButton}" Margin="0,4"/>
                        <Button x:Name="sp_btn_remove_param" Content="&#x25C0;" Style="{StaticResource ArrowButton}" Margin="0,4"/>
                    </StackPanel>
                    <Border Grid.Column="3" BorderBrush="#D0D0D0" BorderThickness="1" Margin="4,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F0F0F0" Padding="6,4">
                                <TextBlock Text="Selected Parameters" FontWeight="SemiBold" FontSize="12"/>
                            </Border>
                            <Grid Grid.Row="1" Margin="4">
                                <TextBox x:Name="sp_search_sel_params" Height="24" FontSize="11"
                                         VerticalContentAlignment="Center" Padding="4,0"/>
                            </Grid>
                            <ListBox x:Name="sp_sel_param_list" Grid.Row="2" BorderThickness="0"
                                     SelectionMode="Extended"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </TabItem>

        <!-- PREVIEW/EDIT TAB -->
        <TabItem x:Name="tab_preview" Header="Preview/Edit" Style="{StaticResource TabStyle}">
            <Grid Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,8">
                    <TextBlock Text="Preview data before export. Edit values and import back to Revit."
                               FontSize="12" Foreground="#666" VerticalAlignment="Center"/>
                    <Button x:Name="btn_refresh_preview" Content="Refresh Preview"
                            Style="{StaticResource SmallButton}" Margin="16,0,0,0" Padding="10,4"/>
                </StackPanel>
                <Border Grid.Row="1" BorderBrush="#D0D0D0" BorderThickness="1">
                    <DataGrid x:Name="preview_grid" AutoGenerateColumns="True"
                              CanUserAddRows="False" CanUserDeleteRows="False"
                              IsReadOnly="False"
                              GridLinesVisibility="All"
                              HorizontalGridLinesBrush="#E0E0E0"
                              VerticalGridLinesBrush="#E0E0E0"
                              AlternatingRowBackground="#FAFAFA"
                              RowBackground="White"
                              Background="White"
                              BorderThickness="0"
                              ScrollViewer.VerticalScrollBarVisibility="Auto"
                              ScrollViewer.HorizontalScrollBarVisibility="Auto"/>
                </Border>
            </Grid>
        </TabItem>
    </TabControl>

    <!-- Row 3: Bottom options -->
    <Border Grid.Row="3" Background="#F5F5F5" BorderBrush="#D0D0D0" BorderThickness="0,1,0,0" Padding="10,6">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <CheckBox x:Name="chk_include_linked" Grid.Column="0" Content="Include Linked Files"
                      VerticalAlignment="Center" Margin="0,0,16,0" FontSize="11"/>
            <CheckBox x:Name="chk_export_type_id" Grid.Column="1" Content="Export by Type ID"
                      VerticalAlignment="Center" Margin="0,0,16,0" FontSize="11"/>

            <!-- Color Legend -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                <Border Background="#8BC34A" Width="16" Height="16" Margin="0,0,4,0" CornerRadius="2"/>
                <TextBlock Text="Instance" VerticalAlignment="Center" Margin="0,0,12,0" FontSize="11"/>
                <Border Background="#FFC107" Width="16" Height="16" Margin="0,0,4,0" CornerRadius="2"/>
                <TextBlock Text="Type" VerticalAlignment="Center" Margin="0,0,12,0" FontSize="11"/>
                <Border Background="#F44336" Width="16" Height="16" Margin="0,0,4,0" CornerRadius="8"/>
                <TextBlock Text="Read-only" VerticalAlignment="Center" FontSize="11"/>
            </StackPanel>

            <!-- Reorder Buttons -->
            <Button x:Name="btn_move_top" Grid.Column="3" Content="&#x23CF;" Style="{StaticResource ArrowButton}"
                    Width="28" Height="28" Margin="2,0" ToolTip="Move to top"/>
            <Button x:Name="btn_move_up" Grid.Column="4" Content="&#x25B2;" Style="{StaticResource ArrowButton}"
                    Width="28" Height="28" Margin="2,0" ToolTip="Move up" FontSize="10"/>
            <Button x:Name="btn_move_down" Grid.Column="5" Content="&#x25BC;" Style="{StaticResource ArrowButton}"
                    Width="28" Height="28" Margin="2,0" ToolTip="Move down" FontSize="10"/>
            <Button x:Name="btn_move_bottom" Grid.Column="6" Content="&#x2B07;" Style="{StaticResource ArrowButton}"
                    Width="28" Height="28" Margin="2,0" ToolTip="Move to bottom"/>
            <Button x:Name="btn_refresh_params" Grid.Column="7" Content="&#x21BB;" Style="{StaticResource ArrowButton}"
                    Width="28" Height="28" Margin="2,0" ToolTip="Refresh" FontSize="14"/>
        </Grid>
    </Border>

    <!-- Row 4: Status bar + Action buttons -->
    <Border Grid.Row="4" Background="White" BorderBrush="#D0D0D0" BorderThickness="0,1,0,0" Padding="10,8">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Status text -->
            <TextBlock x:Name="status_text" Grid.Column="0"
                       Text="Model categories selected 0 | parameters found 0 | parameters selected 0"
                       VerticalAlignment="Center" FontSize="11" Foreground="#666"/>

            <!-- Action Buttons -->
            <Button x:Name="btn_reset" Grid.Column="1" Content="Reset Values"
                    Style="{StaticResource SmallButton}" Margin="0,0,6,0" Padding="12,6"/>
            <Button x:Name="btn_preview" Grid.Column="2" Content="Preview/Edit"
                    Style="{StaticResource SmallButton}" Margin="0,0,6,0" Padding="12,6"
                    Background="#FFC107" FontWeight="SemiBold"/>
            <Button x:Name="btn_import" Grid.Column="3" Content="Import"
                    Style="{StaticResource ActionButton}" Margin="0,0,6,0"
                    Background="#FF9800"/>
            <Button x:Name="btn_export" Grid.Column="4" Content="Export"
                    Style="{StaticResource ActionButton}"
                    Background="#8BC34A"/>
        </Grid>
    </Border>
</Grid>
